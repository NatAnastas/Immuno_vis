[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome",
    "section": "",
    "text": "Welcome to immunovisual, a collection of charts made with the R programming language, focusing on immunogenetics analyses. Different charts types are being organized into multiple sections, each accompanied by its reproducible code. The gallery spotlights the utilization of prominent R packages such as tidyverse, data.table, and ggplot2."
  },
  {
    "objectID": "index.html#who-is-the-site-intended-for",
    "href": "index.html#who-is-the-site-intended-for",
    "title": "Welcome",
    "section": "Who is the site intended for?",
    "text": "Who is the site intended for?\n\nBioscientists who try to find ideas of how to visualize their datasets\nBioinformaticians looking for visualization ideas, code or tricks"
  },
  {
    "objectID": "index.html#who-is-the-site-νοτ-intended-for",
    "href": "index.html#who-is-the-site-νοτ-intended-for",
    "title": "Welcome",
    "section": "Who is the site ΝΟΤ intended for?",
    "text": "Who is the site ΝΟΤ intended for?\n\nBioscientists/bioinformaticians who are trying to process their datasets\nBioscientists who are trying to visualize their datasets via an online platform"
  },
  {
    "objectID": "index.html#contributing",
    "href": "index.html#contributing",
    "title": "Welcome",
    "section": "Contributing",
    "text": "Contributing\nYour input is invaluable - whether it’s suggesting a new chart or reporting a bug, we welcome and greatly appreciate your feedback!\nFeel free to open a GitHub issue or contact us via inab.bioinformatics@lists.certh.gr."
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Welcome",
    "section": "License",
    "text": "License\nThis work, as a whole, is licensed under the MIT license.\nThe code contained in this website is simultaneously available under the MIT license; this means that you are free to use it in your own packages, as long as you cite the source."
  },
  {
    "objectID": "index.html#authors",
    "href": "index.html#authors",
    "title": "Welcome",
    "section": "Authors",
    "text": "Authors\n Natasa Anastasiadou    Nikos Pechlivanis"
  },
  {
    "objectID": "qmd/color_palette.html",
    "href": "qmd/color_palette.html",
    "title": "Color palettes",
    "section": "",
    "text": "Below you can find a list of website helping you to find out different color palettes."
  },
  {
    "objectID": "qmd/color_palette.html#r-color-paletters",
    "href": "qmd/color_palette.html#r-color-paletters",
    "title": "Color palettes",
    "section": "R color paletters",
    "text": "R color paletters\nThe website features a collection of 497 palettes sourced from 16 R packages, categorized into continuous (30 samples), discrete, and dynamic palettes.\nThese palettes can be utilized with the paletteer package, as outlined in each palette’s description, or with their corresponding package. To select a specific color, users can copy the code by simply clicking on the desired color.\nContinuous palettes enable smooth transitions between colors, offering a diverse range of options. Discrete palettes consist of a fixed number of colors, whereas dynamic palettes, a subset of discrete palettes, can adapt to generate a variable number of colors as needed."
  },
  {
    "objectID": "qmd/color_palette.html#color-palette-helper",
    "href": "qmd/color_palette.html#color-palette-helper",
    "title": "Color palettes",
    "section": "Color Palette Helper",
    "text": "Color Palette Helper\nThe website is designed to assist users in creating custom color palettes.\nWith manual options available, users have the freedom to design their palettes according to their specific needs and preferences. They can select their preferred palette type, whether sequential or diverging, and adjust the number of colors to their needs. Following this, users have the option to choose and arrange the input colors. Τhen, they can subsequently review and adjust the resulting palette before exporting the color codes.\nAdditionally, the website provides information on whether the palette is colorblind-safe, ensuring inclusivity and accessibility in design choices."
  },
  {
    "objectID": "qmd/diversity.html",
    "href": "qmd/diversity.html",
    "title": "Diversity estimation",
    "section": "",
    "text": "Diversity estimation within immune cell populations is a fundamental analysis in immunoinformatics. Diversity estimation refers to the process of analyzing and quantifying the diversity of immune cells, such as T cells or B cells."
  },
  {
    "objectID": "qmd/diversity.html#diversity-indeces",
    "href": "qmd/diversity.html#diversity-indeces",
    "title": "Diversity estimation",
    "section": "Diversity indeces",
    "text": "Diversity indeces\nThe repDiversity function offers various approaches for estimating repertoire diversity. The method parameter allows users to specify the means for diversity estimation. Users can select one of the following methods to set the means for diversity estimation:\n\nshannon Shannon index takes into account both the number of different species and the distribution of individuals among those species, providing a single numerical value that reflects the diversity within a community. Higher Shannon index values indicate greater diversity.\nchao1 Chao1 is a nonparametric asymptotic estimator used to estimate species richness, which refers to the total number of species present in a population or community.\nhill Hill numbers represent a unified family of diversity indices characterized by a mathematical framework, with the only variation being the exponent q.\ndiv Div, known as true diversity or the effective number of types, represents the count of equally abundant types required for the average proportional abundance of the types to match that observed in the dataset of interest, where all types may not be equally abundant.\ngini.simp The Gini-Simpson index quantifies the probability of interspecific encounter, indicating the likelihood that two randomly selected entities within a community represent different types or species.\ninv.simp Inverse Simpson index represents the effective number of types achieved when the weighted arithmetic mean is utilized to quantify the average proportional abundance of types within the dataset of interest.\ngini The Gini coefficient measures the inequality among values in a frequency distribution, such as income levels. A Gini coefficient of zero signifies complete equality, where all values are identical (e.g., everyone has the same income). Conversely, a Gini coefficient of one, or 100%, represents maximum inequality among values (e.g., where one person possesses all the income).\nraref Rarefaction is a statistical technique used to estimate species richness based on sampled data by extrapolating the expected number of species in a population."
  },
  {
    "objectID": "qmd/diversity.html#table-data-format",
    "href": "qmd/diversity.html#table-data-format",
    "title": "Diversity estimation",
    "section": "Table (Data format)",
    "text": "Table (Data format)\nThis is an example of a data format containing the necessary information for diversity estimation visualizations. The table includes mock data specifically generated for this purpose.\nThe “Sample” column contains unique identifiers for each sample, while the “Group” column indicates the different groups to which the samples belong. The “Patient” column provides information about the respective patients associated with each sample. The “Shannon” column corresponds to the Shannon index utilized for the diversity analysis.\n\n\nCode\nlibrary(data.table)\nlibrary(reactable)\n\ndf = fread(\"../inst/data/diversity1.txt\")\n\nreactable(\n  \n  df, \n  theme = reactableTheme(\n    backgroundColor  = \"#d9e3f1\"\n  )\n)"
  },
  {
    "objectID": "qmd/diversity.html#boxplot",
    "href": "qmd/diversity.html#boxplot",
    "title": "Diversity estimation",
    "section": "Boxplot",
    "text": "Boxplot\nBoxplot is one of the most commonly used chart types for comparing the distribution of a numeric variable across multiple groups.\nIn a boxplot, the central line within the box represents the median of the data, dividing it into two equal parts. The edges of the box represent the upper and lower quartiles, while the extreme lines extend to the the highest and lowest values within the data range, excluding outliers.\nBoxplots are created using the geom_boxplot() function from the ggplot2 package.\n\nBoxplot 1\nIt’s important to note that while boxplots provide a summary of data distribution for each group, they may hide the underlying distribution details.\nTo address this concern, a common practice is to overlay individual data points using geom_point() behind the boxplot, offering a clearer visualization of the dataset’s distribution.\n\n\nCode\n# libraries -------\n\nlibrary(ggplot2)\nlibrary(ggforce)\n\nlibrary(paletteer)\n# plot 1 ---------------------\n\ndf |&gt;\n    ggplot(aes(Group, Shannon)) +\n    \n    geom_point(\n        aes(fill = Group),\n        position = position_jitternormal(sd_y = 0, sd_x = .08),\n        shape = 21, size = 2, stroke = .15, color = \"white\"\n    ) +\n\n    scale_fill_manual(values = paletteer_d(\"ggsci::hallmarks_light_cosmic\")) +\n    \n    geom_boxplot(width = .15, outlier.shape = NA) +\n    \n    theme_minimal() +\n    \n    theme(\n        legend.position = \"none\",\n        \n        axis.line = element_line(linewidth = .55),\n        axis.ticks = element_line(linewidth = .55),\n        \n        panel.grid.major = element_line(linewidth = .55),\n        panel.grid.minor = element_line(linewidth = .45, linetype = \"dashed\"),\n        \n        plot.background = element_rect(fill = \"#d9e3f1\", color = NA),\n        plot.margin = margin(20, 20, 20, 20)\n    )\n\n\n\n\n\n\n\nBoxplot 2\nThe box plot illustrates the Shannon index on the y-axis with distinct patient groups depicted along the x-axis. Different colors are employed to distinguish between the two patient groups.\n\n\nCode\n# libraries ------------\n\nlibrary(ggnewscale)\nlibrary(colorspace)\n\n# plot 2 ------------\n\ndf |&gt;\n  ggplot(aes(Group, Shannon)) +\n    \n  geom_point(\n      aes(fill = Patient),\n      position = position_jitterdodge(jitter.width = .15, dodge.width = .5),\n      shape = 21, size = 2, stroke = .15, color = \"white\"\n  ) +\n\n  scale_fill_manual(values = paletteer_d(\"ggsci::hallmarks_light_cosmic\") |&gt; lighten(.25)) +\n\n  geom_boxplot(\n    aes(color = Patient),\n    position = position_dodge(width = .5),\n    width = .2, outlier.shape = NA\n  ) +\n  \n  scale_color_manual(values = paletteer_d(\"ggsci::hallmarks_light_cosmic\") |&gt; darken(.25)) +\n  \n  theme_minimal() +\n  \n  theme(\n      legend.position = \"bottom\",\n      legend.justification = \"left\",\n      legend.title = element_blank(),\n      \n      axis.line = element_line(linewidth = .55),\n      axis.ticks = element_line(linewidth = .55),\n      \n      panel.grid.major = element_line(linewidth = .55),\n      panel.grid.minor = element_line(linewidth = .45, linetype = \"dashed\"),\n      \n      plot.background = element_rect(fill = \"#d9e3f1\", color = NA),\n      plot.margin = margin(20, 20, 20, 20)\n  )"
  },
  {
    "objectID": "qmd/gene_repertoire.html",
    "href": "qmd/gene_repertoire.html",
    "title": "Gene repertoire",
    "section": "",
    "text": "Code\nlibrary(data.table)\nlibrary(reactable)\n\ndf = fread(\"../inst/data/diversity1.txt\")\n\nreactable(df)"
  },
  {
    "objectID": "qmd/diversity.html#diversity-indeces",
    "href": "qmd/diversity.html#diversity-indeces",
    "title": "Diversity estimation",
    "section": "Diversity indeces",
    "text": "Diversity indeces\nThere are several approaches to the estimation of repertoire diversity implemented in the repDiversity function. The method parameter similarly to above mentioned functions sets the means for diversity estimation. You can choose one of the following methods:\n\nshannon Shannon index takes into account both the number of different species and the distribution of individuals among those species, providing a single numerical value that reflects the diversity within a community. Higher Shannon index values indicate greater diversity.\nchao1 Chao is a nonparameteric asymptotic estimator of species richness (number of species in a population).\nhill Hill numbers are a mathematically unified family of diversity indices (differing only by an exponent q).\ndiv true diversity, or the effective number of types, refers to the number of equally abundant types needed for the average proportional abundance of the types to equal that observed in the dataset of interest where all types may not be equally abundant.\ngini.simp The Gini-Simpson index is the probability of interspecific encounter, i.e., probability that two entities represent different types.\ninv.simp Inverse Simpson index is the effective number of types that is obtained when the weighted arithmetic mean is used to quantify average proportional abundance of types in the dataset of interest.\ngini The Gini coefficient measures the inequality among values of a frequency distribution (for example levels of income). A Gini coefficient of zero expresses perfect equality, where all values are the same (for example, where everyone has the same income). A Gini coefficient of one (or 100 percents ) expresses maximal inequality among values (for example where only one person has all the income).\nraref Rarefaction is a technique to assess species richness from the results of sampling through extrapolation."
  },
  {
    "objectID": "qmd/color_palette.html#r-color-paletters",
    "href": "qmd/color_palette.html#r-color-paletters",
    "title": "Color palettes",
    "section": "R color paletters",
    "text": "R color paletters\nThe website features a collection of 497 palettes sourced from 16 R packages, categorized into continuous (30 samples), discrete, and dynamic palettes.\nThese palettes can be utilized with the paletteer package, as outlined in each palette’s description, or with their corresponding package. To select a specific color, users can copy the code by simply clicking on the desired color.\nContinuous palettes enable smooth transitions between colors, offering a diverse range of options. Discrete palettes consist of a fixed number of colors, whereas dynamic palettes, a subset of discrete palettes, can adapt to generate a variable number of colors as needed."
  },
  {
    "objectID": "qmd/color_palette.html#chroma.js-color-palette-helper",
    "href": "qmd/color_palette.html#chroma.js-color-palette-helper",
    "title": "Color palettes",
    "section": "Chroma.js-Color Palette Helper",
    "text": "Chroma.js-Color Palette Helper\nThe site offers more manual options. Users can select their preferred palette type (sequential or diverging), then choose and arrange the input colors. They can subsequently review and adjust the resulting palette before exporting the color codes."
  },
  {
    "objectID": "qmd/gene_repertoire.html#table-data-format",
    "href": "qmd/gene_repertoire.html#table-data-format",
    "title": "Gene repertoire",
    "section": "",
    "text": "Code\nlibrary(data.table)\nlibrary(reactable)\n\ndf = fread(\"../inst/data/diversity1.txt\")\n\nreactable(df)"
  },
  {
    "objectID": "qmd/color_palette.html#color-palette-helper",
    "href": "qmd/color_palette.html#color-palette-helper",
    "title": "Color palettes",
    "section": "Color Palette Helper",
    "text": "Color Palette Helper\nThe website is designed to assist users in creating custom color palettes.\nWith manual options available, users have the freedom to design their palettes according to their specific needs and preferences. They can select their preferred palette type, whether sequential or diverging, and adjust the number of colors to their needs. Following this, users have the option to choose and arrange the input colors. Τhen, they can subsequently review and adjust the resulting palette before exporting the color codes.\nAdditionally, the website provides information on whether the palette is colorblind-safe, ensuring inclusivity and accessibility in design choices."
  },
  {
    "objectID": "qmd/V(D)J_recombination.html",
    "href": "qmd/V(D)J_recombination.html",
    "title": "V(D)J recombination",
    "section": "",
    "text": "V(D)J recombination stands as a fundamental mechanism within the adaptive immune system, crucial for formation of the immunoglobulins."
  },
  {
    "objectID": "qmd/V(D)J_recombination.html#table-data-format",
    "href": "qmd/V(D)J_recombination.html#table-data-format",
    "title": "V(D)J recombination",
    "section": "Table (Data format)",
    "text": "Table (Data format)\nThis is an example of a data format containing the necessary information for V(D)J recombination visualizations. The table includes mock data specifically generated for this purpose.\nThe “IGLJ” column contains the different IGLJ genes, while all the other columns correspond to the various IGLV genes.\n\n\nCode\nlibrary(readxl)\nlibrary(reactable)\n\ndf &lt;- read_excel(\"../inst/data/chordDiagram.xlsx\") |&gt;\n      as.data.frame()\n\n\nreactable(\n  \n  df, \n  theme = reactableTheme(\n    backgroundColor  = \"#d9e3f1\"\n  )\n)"
  },
  {
    "objectID": "qmd/V(D)J_recombination.html#chord-diagram",
    "href": "qmd/V(D)J_recombination.html#chord-diagram",
    "title": "V(D)J recombination",
    "section": "Chord diagram",
    "text": "Chord diagram\nChord diagrams provide a circular visualization of relationships between multiple entities (nodes) through interconnected links.\nEach entity is represented by a segment on the outer perimeter of the circular layout, with arcs drawn between them to show connections.\nThe size of each arc corresponds to the significance of the flow between the respective entities.\n\nChord diagram 1\nThis chord diagram illustrates the different recobinations between IGLJ genes and IGLV genes.\n\n\nCode\nlibrary(readxl)\nsuppressPackageStartupMessages(library(circlize))\nlibrary(data.table)\n\n\n# import data\ndf &lt;- read_excel(\"../inst/data/chordDiagram.xlsx\") |&gt;\n      as.data.frame()\n\n\n# change df\nrownames(df) &lt;- df$IGLJ\ndf$IGLJ = NULL\ndf = as.matrix(df)\n\n\n\n# Define specific colors for names\ngrid.col1 = c(IGLJ3 = \"#D53E4F\",IGLJ2 = \"#5E4FA2\", IGLJ1 =\"#66C2A5\")\n\n# Define specific colors for the IGJV sectors\niglj_colors &lt;- c(IGLJ3 = \"#D53E4F\", IGLJ2 = \"#5E4FA2\", IGLJ1 =\"#66C2A5\")\n\n# Extract sector names from the data frame that start with \"IGJV\"\niglj_sectors &lt;- colnames(df)[startsWith(colnames(df), \"IGLJ\")]\n\n# Exclude sectors that are already in grid.col1\niglj_sectors &lt;- setdiff(iglj_sectors, names(grid.col1))\n\n\n\n# Assign specific colors to the IGJV sectors\nfor (i in seq_along(iglj_sectors)) {\n  grid.col1[iglj_sectors[i]] &lt;- iglj_colors[i]\n}\n\n\n# Extract entity names from the data frame that start with \"IGLV\"\niglv_entities &lt;- colnames(df)[startsWith(colnames(df), \"IGLV\")]\n\n# Exclude entities that are already in grid.col1\niglv_entities &lt;- setdiff(iglv_entities, names(grid.col1))\n\n\n\n# Assign them the color \"grey\"\nfor (entity in iglv_entities) {\n  grid.col1[entity] &lt;- \"grey10\"\n}\n\n\n# chord diagram\n# vertical symmetric\ncircos.clear()\ncircos.par(start.degree = -90)\n\n\n# empty track\nchordDiagram(df, grid.col = grid.col1, annotationTrack = c(\"grid\", \"names\"),\n             annotationTrackHeight = c(0.01, 0.001),\n             preAllocateTracks = list(track.height = 0.1))\n\n\n# customize labels\ncircos.track(track.index = 1, panel.fun = function(x, y) {\n  circos.text(CELL_META$xcenter, CELL_META$ylim[1], CELL_META$sector.index, \n              facing = \"clockwise\", niceFacing = TRUE, adj = c(0, 0.5),\n              cex = 0.5)\n}, bg.border = NA)"
  },
  {
    "objectID": "qmd/clonotype_evolution.html",
    "href": "qmd/clonotype_evolution.html",
    "title": "Clonotype evolution",
    "section": "",
    "text": "Clonotype evolution refers to the dynamic changes that occur in the composition and characteristics of clonotypes over time or in response to selective pressures within a biological system, such as the immune repertoire."
  },
  {
    "objectID": "qmd/clonotype_evolution.html#boxplot",
    "href": "qmd/clonotype_evolution.html#boxplot",
    "title": "Clonotype evolution",
    "section": "Boxplot",
    "text": "Boxplot\nBoxplot is one of the most commonly used chart types for comparing the distribution of a numeric variable across multiple groups.\nIn a boxplot, the central line within the box represents the median of the data, dividing it into two equal parts. The edges of the box represent the upper and lower quartiles, while the extreme lines extend to the the highest and lowest values within the data range, excluding outliers.\nBoxplots are created using the geom_boxplot() function from the ggplot2 package.\n\nBoxplot 1\nIt’s important to note that while boxplots provide a summary of data distribution for each group, they may hide the underlying distribution details.\nTo address this concern, a common practice is to overlay individual data points using geom_point() behind the boxplot, offering a clearer visualization of the dataset’s distribution.\n\n\nCode\n# libraries -------\n\nlibrary(ggplot2)\nlibrary(ggforce)\n\nlibrary(paletteer)\n# plot 1 ---------------------"
  },
  {
    "objectID": "qmd/clonotype_evolution.html#plot",
    "href": "qmd/clonotype_evolution.html#plot",
    "title": "Clonotype evolution",
    "section": "plot",
    "text": "plot\n\nplot 1\n\n\nCode\n# libraries -------\n\nlibrary(ggplot2)\nlibrary(ggstream)\nlibrary(paletteer)\n\n\n# plot 1 ---------------------\n\nd1 |&gt; \n    ggplot(aes(time, Freq, fill = clonotype)) +\n    \n    # geom_stream(\n    #     geom = \"contour\",\n    #     color = \"grey20\",\n    #     linewidth = 2,\n    #     bw = .75,\n    #     extra_span = .75,\n    #     true_range = \"both\",\n    #     sorting = \"inside_out\"\n    # ) +\n    \n    geom_stream(\n        type = \"mirror\",\n        # geom = \"polygon\",\n        color = \"grey96\",\n        linewidth = .05,\n        bw = .75,\n        extra_span = .75,\n        true_range = \"both\",\n        sorting = \"inside_out\"\n    ) +\n    \n    geom_vline(\n        data = data.table(x = c(1, 2, 3, 4, 5)),\n        aes(xintercept = x),\n        color = \"white\", \n        linewidth = 1,\n        linetype = \"dotted\"\n    ) +\n    \n    scale_x_discrete(expand = c(0, 0)) +\n    scale_fill_manual(\n        values = paletteer_d(\"ggsci::hallmarks_light_cosmic\"),\n        guide = guide_legend(nrow = 4)\n    ) +\n    \n    theme_minimal() +\n    \n    theme(\n        legend.position = \"bottom\",\n        legend.title.position = \"top\",\n        \n        axis.title.x = element_blank(),\n        axis.text.x = element_text(face = \"bold\"),\n        \n        panel.grid = element_blank(),\n        \n        plot.margin = margin(20, 20, 20, 20),\n        \n        plot.background = element_rect(fill = \"#d9e3f1\", color = NA)\n    )"
  },
  {
    "objectID": "qmd/clonotype_evolution.html#table-data-format",
    "href": "qmd/clonotype_evolution.html#table-data-format",
    "title": "Clonotype evolution",
    "section": "Table (Data format)",
    "text": "Table (Data format)\nThis is an example of a data format containing the necessary information for diversity estimation visualizations. The table includes mock data specifically generated for this purpose.\nThe “patient” column identifies specific patients within the dataset. The “sample” column contains unique identifiers for each sample, while the “time” column indicates the different timepoint which each sample was taken. The “response” column provides information regarding the outcome associated with each sample. In the “vgene” column, various V genes are listed, while “CDR3” column contains the corresponding CDR3 sequences. The “clonotype” column represents different clonotypes, the “N” indicates the number of times each clonotype was detected and “Freq” column displays to the frequency of each clonotype.\n\n\nCode\nlibrary(stringr)\nlibrary(data.table)\nlibrary(reactable)\n\n\nd0 = fread(\"../inst/data/clonotype-evolution-1.tsv\")\n\nd0$time = d0$time |&gt; factor(levels = c(\"PRE\", \"6M\", \"12M\", \"18M\", \"24M\"))\n\nd1 = d0[which(patient == 13)]\n\ncl = d1[which(time == \"PRE\"), head(.SD, 10)]$clonotype\n\nd1 = d1[which(clonotype %in% cl)] \n\n\nreactable(\n\n  d1,\n  defaultPageSize = 5,\n  theme = reactableTheme(\n    backgroundColor  = \"#d9e3f1\"\n  )\n)"
  },
  {
    "objectID": "qmd/clonotype_evolution.html#stream-graph",
    "href": "qmd/clonotype_evolution.html#stream-graph",
    "title": "Clonotype evolution",
    "section": "Stream graph",
    "text": "Stream graph\nA Stream graph is a variant of a stacked area chart that illustrates the progression of a numeric value (Y-axis) over another numeric value (X-axis). It visualizes this evolution across multiple groups, each distinguished by a unique color.\n\nStream graph\nThe following example shows the evolution of each colonotype through time within a single patient.\n\n\nCode\n# libraries -------\n\nlibrary(ggplot2)\nlibrary(ggstream)\nlibrary(paletteer)\n\n\n# plot 1 ---------------------\n\nd1 |&gt; \n    ggplot(aes(time, Freq, fill = clonotype)) +\n    \n    geom_stream(\n        type = \"mirror\",\n        color = \"grey96\",\n        linewidth = .05,\n        bw = .75,\n        extra_span = .75,\n        true_range = \"both\",\n        sorting = \"inside_out\"\n    ) +\n    \n    geom_vline(\n        data = data.table(x = c(1, 2, 3, 4, 5)),\n        aes(xintercept = x),\n        color = \"white\", \n        linewidth = 1,\n        linetype = \"dotted\"\n    ) +\n    \n    scale_x_discrete(expand = c(0, 0)) +\n    scale_fill_manual(\n        values = paletteer_d(\"ggsci::hallmarks_light_cosmic\"),\n        guide = guide_legend(nrow = 4)\n    ) +\n    \n    theme_minimal() +\n    \n    theme(\n        legend.position = \"bottom\",\n        legend.title.position = \"top\",\n        \n        axis.title.x = element_blank(),\n        axis.text.x = element_text(face = \"bold\"),\n        \n        panel.grid = element_blank(),\n        \n        plot.margin = margin(20, 20, 20, 20),\n        \n        plot.background = element_rect(fill = \"#d9e3f1\", color = NA)\n    )"
  }
]